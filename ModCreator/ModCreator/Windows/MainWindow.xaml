<local:CWindow x:Class="ModCreator.MainWindow"
        x:TypeArguments="localData:MainWindowData"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ModCreator.Windows"
        xmlns:localData="clr-namespace:ModCreator.WindowData"
        xmlns:helper="clr-namespace:ModCreator.Helpers"
        xmlns:converters="clr-namespace:ModCreator.Converters"
        mc:Ignorable="d"
        Title="{x:Static helper:MessageHelper.AppTitle}" 
        Height="600" Width="1000" 
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Icon="/Resources/app-icon.png"
        FontFamily="Segoe UI">
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisConverter"/>
        <converters:ProjectStateToBackgroundConverter x:Key="ProjectStateToBackgroundConverter"/>
        <converters:ProjectStateToTextConverter x:Key="ProjectStateToTextConverter"/>
        <converters:ProjectStateToIsEnabledConverter x:Key="ProjectStateToIsEnabledConverter"/>
        <Style TargetType="GroupBox">
            <Setter Property="Padding" Value="10"/>
            <Setter Property="Margin" Value="5"/>
        </Style>
        <Style TargetType="TextBlock" x:Key="LabelText">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,5,10,5"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
        <Style x:Key="ProjectGridCellStyle" TargetType="DataGridCell">
            <Setter Property="Padding" Value="8,8"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#FFB0B0B0"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
        </Style>
        <Style x:Key="ProjectGridHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Padding" Value="8,8"/>
            <Setter Property="Background" Value="#FF2E5090"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
        </Style>
        <Style x:Key="CenterTextBlockStyle" TargetType="TextBlock">
            <Setter Property="TextAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
        <Style x:Key="LeftTextBlockStyle" TargetType="TextBlock">
            <Setter Property="TextAlignment" Value="Left"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="8,0,0,0"/>
        </Style>
    </Window.Resources>
    
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#FF2E5090" Padding="15" Margin="0,0,0,10" CornerRadius="5">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0">
                    <TextBlock Text="{x:Static helper:MessageHelper.AppName}" FontSize="24" FontWeight="Bold" Foreground="White"/>
                    <TextBlock Text="{x:Static helper:MessageHelper.AppSubtitle}" FontSize="12" Foreground="#FFCCCCCC" Margin="0,5,0,0"/>
                </StackPanel>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <Button Content="{x:Static helper:MessageHelper.Help}" Click="Help_Click" 
                            Style="{StaticResource HeaderButton}" 
                            Width="70"
                            Margin="0,0,5,0"/>
                    <Button Content="{x:Static helper:MessageHelper.About}" Click="About_Click" 
                            Style="{StaticResource HeaderButton}" 
                            Width="70"
                            Margin="5,0,0,0"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Workplace Setting -->
        <GroupBox Grid.Row="1" Header="{x:Static helper:MessageHelper.Workplace}" Margin="0,0,0,10">
            <DockPanel>
                <Button Content="{x:Static helper:MessageHelper.Browse}" 
                        Click="BrowseWorkplace_Click"
                        Style="{StaticResource ActionButton}"
                        Width="80" 
                        DockPanel.Dock="Right"
                        Margin="10,0,0,0"/>
                <TextBox Text="{Binding WorkplacePath, Mode=TwoWay, UpdateSourceTrigger=LostFocus}" 
                         Style="{StaticResource StandardTextBox}"
                         DockPanel.Dock="Left"/>
            </DockPanel>
        </GroupBox>

        <!-- Main Content -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="1*"/>
            </Grid.ColumnDefinitions>

            <!-- Projects List -->
            <GroupBox Grid.Column="0" Header="{x:Static helper:MessageHelper.ProjectList}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Toolbar -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <Button Content="{x:Static helper:MessageHelper.CreateNewProject}" Style="{StaticResource PrimaryButton}" Click="CreateProject_Click" Foreground="White"/>
                        <Button Content="{x:Static helper:MessageHelper.RefreshList}" Style="{StaticResource ActionButton}" Click="RefreshProjects_Click"/>
                        <TextBox Text="{Binding SearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                 Width="200" Margin="20,5,5,5" VerticalContentAlignment="Center">
                            <TextBox.Style>
                                <Style TargetType="TextBox">
                                    <Setter Property="Padding" Value="5"/>
                                    <Style.Triggers>
                                        <Trigger Property="Text" Value="">
                                            <Setter Property="Background">
                                                <Setter.Value>
                                                    <VisualBrush Stretch="None" AlignmentX="Left">
                                                        <VisualBrush.Visual>
                                                            <TextBlock Text="{x:Static helper:MessageHelper.SearchPlaceholder}" Foreground="Gray" Margin="5,0,0,0"/>
                                                        </VisualBrush.Visual>
                                                    </VisualBrush>
                                                </Setter.Value>
                                            </Setter>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBox.Style>
                        </TextBox>
                    </StackPanel>

                    <!-- Project List -->
                    <DataGrid Grid.Row="1" 
                              ItemsSource="{Binding FilteredProjects, Mode=OneWay}" 
                              SelectedItem="{Binding SelectedProject, Mode=TwoWay}"
                              AutoGenerateColumns="False" 
                              IsReadOnly="True"
                              SelectionMode="Single"
                              CanUserResizeRows="False"
                              RowHeight="40"
                              ColumnHeaderHeight="48"
                              AlternatingRowBackground="#FFF5F5F5"
                              MouseDoubleClick="ProjectList_DoubleClick"
                              CellStyle="{StaticResource ProjectGridCellStyle}"
                              ColumnHeaderStyle="{StaticResource ProjectGridHeaderStyle}">
                        <DataGrid.RowStyle>
                            <Style TargetType="DataGridRow">
                                <Setter Property="Background" Value="{Binding State, Converter={StaticResource ProjectStateToBackgroundConverter}}"/>
                            </Style>
                        </DataGrid.RowStyle>
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="{x:Static helper:MessageHelper.HeaderProjectName}" 
                                                Binding="{Binding ProjectName, Mode=OneWay}" 
                                                Width="200" 
                                                MinWidth="150"
                                                ElementStyle="{StaticResource LeftTextBlockStyle}"/>
                            <DataGridTextColumn Header="{x:Static helper:MessageHelper.HeaderDescription}" 
                                                Binding="{Binding Description, Mode=OneWay}" 
                                                Width="*" 
                                                MinWidth="200"
                                                ElementStyle="{StaticResource LeftTextBlockStyle}"/>
                            <DataGridTextColumn Header="{x:Static helper:MessageHelper.HeaderId}" 
                                                Binding="{Binding ProjectId, Mode=OneWay}" 
                                                Width="100"
                                                ElementStyle="{StaticResource CenterTextBlockStyle}"/>
                            <DataGridTextColumn Header="{x:Static helper:MessageHelper.HeaderState}" 
                                                Binding="{Binding State, Mode=OneWay, Converter={StaticResource ProjectStateToTextConverter}}" 
                                                Width="100"
                                                ElementStyle="{StaticResource CenterTextBlockStyle}"/>
                            <DataGridTextColumn Header="{x:Static helper:MessageHelper.HeaderCreated}" 
                                                Binding="{Binding CreatedDate, Mode=OneWay, StringFormat=\{0:yyyy-MM-dd\}}" 
                                                Width="110"
                                                ElementStyle="{StaticResource CenterTextBlockStyle}"/>
                            <DataGridTextColumn Header="{x:Static helper:MessageHelper.HeaderModified}" 
                                                Binding="{Binding LastModifiedDate, Mode=OneWay, StringFormat=\{0:yyyy-MM-dd\}}" 
                                                Width="110"
                                                ElementStyle="{StaticResource CenterTextBlockStyle}"/>
                            <DataGridTemplateColumn Header="{x:Static helper:MessageHelper.HeaderActions}" Width="110">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <Button Content="{x:Static helper:MessageHelper.GridOpenFolder}" 
                                                    ToolTip="{x:Static helper:MessageHelper.TooltipOpenFolder}" 
                                                    Click="GridOpenFolder_Click" 
                                                    IsEnabled="{Binding State, Converter={StaticResource ProjectStateToIsEnabledConverter}}"
                                                    Width="30" Margin="2" Padding="2"/>
                                            <Button Content="{x:Static helper:MessageHelper.GridEditInfo}" 
                                                    ToolTip="{x:Static helper:MessageHelper.TooltipEditInfo}" 
                                                    Click="GridEditProject_Click" 
                                                    IsEnabled="{Binding State, Converter={StaticResource ProjectStateToIsEnabledConverter}}"
                                                    Width="30" Margin="2" Padding="2"/>
                                            <Button Content="{x:Static helper:MessageHelper.GridDelete}" 
                                                    ToolTip="{x:Static helper:MessageHelper.TooltipDelete}" 
                                                    Click="GridDeleteProject_Click" Width="30" Margin="2" Padding="2" Foreground="Red"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </GroupBox>

            <!-- Project Details & Actions -->
            <StackPanel Grid.Column="1">
                <GroupBox Header="{x:Static helper:MessageHelper.ProjectDetails}">
                    <StackPanel x:Name="pnlProjectDetails">
                        <TextBlock Text="{x:Static helper:MessageHelper.NoProjectSelected}" x:Name="txtNoSelection" 
                                   Foreground="Gray" HorizontalAlignment="Center" Margin="20"
                                   Visibility="{Binding HasNoSelectedProject, Converter={StaticResource BoolToVisConverter}}"/>

                        <StackPanel x:Name="pnlDetails" Visibility="{Binding HasSelectedProject, Converter={StaticResource BoolToVisConverter}}">
                            <StackPanel Orientation="Horizontal" Margin="0,5">
                                <TextBlock Text="{x:Static helper:MessageHelper.ProjectDetailsName}" Style="{StaticResource LabelText}" Width="100"/>
                                <TextBlock Text="{Binding ProjectName, Mode=OneWay}" TextWrapping="Wrap"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,5">
                                <TextBlock Text="{x:Static helper:MessageHelper.ProjectDetailsId}" Style="{StaticResource LabelText}" Width="100"/>
                                <TextBlock Text="{Binding ProjectId, Mode=OneWay}" TextWrapping="Wrap"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,5">
                                <TextBlock Text="{x:Static helper:MessageHelper.ProjectDetailsModId}" Style="{StaticResource LabelText}" Width="100"/>
                                <TextBlock Text="{Binding ModId, Mode=OneWay}" TextWrapping="Wrap"/>
                            </StackPanel>
                            <StackPanel Margin="0,5">
                                <TextBlock Text="{x:Static helper:MessageHelper.ProjectDetailsPath}" Style="{StaticResource LabelText}"/>
                                <TextBlock Text="{Binding ProjectPath, Mode=OneWay}" TextWrapping="Wrap" Margin="5"/>
                            </StackPanel>
                            <StackPanel Margin="0,5">
                                <TextBlock Text="{x:Static helper:MessageHelper.ProjectDetailsDescription}" Style="{StaticResource LabelText}"/>
                                <TextBlock Text="{Binding Description, Mode=OneWay}" TextWrapping="Wrap" Margin="5"/>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="{x:Static helper:MessageHelper.Actions}">
                    <StackPanel x:Name="pnlActions" IsEnabled="{Binding IsSelectedProjectValid}">
                        <Button Content="{x:Static helper:MessageHelper.OpenFolder}" Click="OpenFolder_Click" Margin="5"/>
                        <Button Content="{x:Static helper:MessageHelper.EditInfo}" Click="EditProject_Click" Margin="5"/>
                        <Separator Margin="5,10"/>
                        <Button Content="{x:Static helper:MessageHelper.RemoveProject}" Click="DeleteProject_Click" Margin="5"/>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="{x:Static helper:MessageHelper.Info}">
                    <StackPanel>
                        <TextBlock TextWrapping="Wrap" FontSize="11" Foreground="Gray">
                            <Run Text="{x:Static helper:MessageHelper.TotalProjects}"/>
                            <Run Text="{Binding TotalCount, Mode=OneWay}" FontWeight="Bold"/>
                        </TextBlock>
                        <TextBlock Text="{x:Static helper:MessageHelper.Template}" 
                                   FontSize="11" Foreground="Gray" Margin="0,5,0,0"/>
                    </StackPanel>
                </GroupBox>
            </StackPanel>
        </Grid>

        <!-- Status Bar -->
        <Border Grid.Row="3" Background="#FFF0F0F0" Padding="10,5" Margin="0,10,0,0" CornerRadius="3">
            <TextBlock Text="{Binding StatusMessage, Mode=OneWay}" FontSize="11"/>
        </Border>
    </Grid>
</local:CWindow>
